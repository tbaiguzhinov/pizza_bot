# Бот для заказа пиццы (Telegram & Facebook)

Бот создан для заказа пиццы по уроку 6  "Принимаем платежи за пиццу" курса [Devman](https://dvmn.org).

Код задеплоен в Телеграмме [здесь](https://t.me/pizza_dvmn_tbu_bot), и в Фэйсбуке [здесь](https://www.facebook.com/profile.php?id=100087221290088).

## Запуск в Телеграмме

- Скачайте код
- Установите зависимости командой  
```pip install -r requirements.txt```
- Запустите бот в Телеграмме командой  
```python3 main.py```

## Запуск в Фэйсбуке

- Скачайте код
- Установите зависимости командой  
```pip install -r requirements.txt```
- Запустите бот командой  
```python3 app.py```
- Запустите ngrok с указанием порта (обычно 5000)  
```ngrok http 5000```
- Скопируйте внешний IP адрес, вставьте его в адрес webhook-а на странице для разработчиков.  
- Вставьте токен, который укажите в переменных окружениях ниже.

## Обновление базы данных

- Для периодического обновления базы данных с кешем, запустите обновление командой  
```python3 update_db.py```

## Переменные окружения

Для корректной работы кода, необходимы переменные окружения. Чтобы их определить, создайте файл `.env` рядом с `main.py` и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

* `MOLTIN_CLIENT_ID` - ID клиента в API сервисе [Elastic Path](https://www.elasticpath.com/) (бывший Moltin).
* `MOLTIN_CLIENT_SECRET` - Секретный код клиента в API сервисе Elastic Path.
* `LOGGER_BOT_TOKEN` - токен Telegram бота для отображения логов.
* `TELEGRAM_CHAT_ID` - ваш ID в Телеграм. Чтобы его получить, напишите в Telegram боту @userinfobot.
* `TELEGRAM_TOKEN` - токен Telegram бота, в котором будет работать бот для викторин.
* `DATABASE_PASSWORD` - пароль для входа в базу данных Redis.
* `DATABASE_HOST` - ссылка на базу данных Redis.
* `DATABASE_PORT` - порт базы данных Redis.
* `YANDEX_KEY` - API ключ сервиса Yandex "Javascript API и HTTP Геокодер".
* `FB_PAGE_ACCESS_TOKEN` - Токен разработчика от Facebook.
* `FB_VERIFY_TOKEN` - Токен для верификации webhook-а в Facebook.


## Цели проекта

Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman](https://dvmn.org).